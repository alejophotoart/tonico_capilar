var i=0;function trashProduct(e){console.log(e),i-=1,$("."+e).remove()}function minTwoDigits(e){return(e<10?"0":"")+e}function EditOrder(e,t,o,n,a){let i=document.getElementById("identification").value,r=document.getElementById("name").value,l=document.getElementById("address").value,c=document.getElementById("neighborhood").value,d=document.getElementById("phone").value,u=document.getElementById("whatsapp").value,s=document.getElementById("country_id").value,m=document.getElementById("state_id").value,f=document.getElementById("city_id").value,p=document.getElementById("payment_type_id").value;if(""==$("#delivery_date").val()||null==$("#delivery_date").val()||null==$("#delivery_date").val())var y=a;else{y=document.getElementById("delivery_date").value;var g=document.getElementById("reason").value}let v=document.getElementById("notes").value,B=document.getElementById("total").value,h=(document.getElementById("LoadVoucher").value,[]),w=[];for(var C=0;C<$(".copy_quantity").length;C++)h.push($(".copy_quantity")[C].value);for(C=0;C<$(".copy").length;C++)w.push($(".copy")[C].value);var S=[h,w];let E=B.replace(/\$/g,"").replace(/\./g,"");console.log(S[1]);for(var I=0;I<$(".copy_quantity").length;I++)if($(".copy_quantity")[I].value<=0||""==$(".copy_quantity")[I].value)return Swal.fire({icon:"warning",title:"Cantidad",text:"La cantidad digitada no es valida",confirmButtonColor:"#343a40"}),!1;return 0!==S[1].length&&S[1].length?0==i||""==i||0==r||""==r||0==l||""==l||0==d||""==d||0==c||""==c||0==u||""==u||0==y||""==y||0==E||""==E||0==p||""==p||0==s||""==s||0==m||""==m||0==f||""==f?(console.log(),Swal.fire({icon:"info",title:"Campos vacios",text:"Existen campos vacios, por favor llenelos",confirmButtonColor:"#343a40",showConfirmButton:!0}),!1):void Swal.fire({title:"Estas seguro?",text:"Deseas actualizar este nuevo pedido",icon:"question",showCancelButton:!0,confirmButtonColor:"#343a40",cancelButtonColor:"#d33",confirmButtonText:"Si, Actualizarlo!",cancelButtonText:"Cancelar"}).then(a=>{if(a.isConfirmed){let a,s={id:e,client_id:t,address_id:o,user_id:n,identification:i,name:r,address:l,neighborhood:c,phone:d,whatsapp:u,payment_type_id:p,delivery_date:y,reason:g,notes:v,prod_quan:S,total:E,city_id:f};console.log(s),Swal.fire({title:"Actualizando Pedido",didOpen:()=>{Swal.showLoading(),a=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),$.ajax({url:"/pedidos/editar/"+e,type:"PUT",data:JSON.stringify(s),contentType:"application/json",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){if(500==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(400==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(404==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;var t=document.getElementById("LoadVoucher");if(t=t.files[0]){saveImage(e.id,e.name)}else{if(200!=e.status)return 100==e.status?(Swal.fire({icon:e.icon,title:e.title,text:e.message,confirmButtonColor:"#343a40"}),!1):(Swal.fire({icon:"error",title:"Ops...",text:"Ocurrio un error inesperado",confirmButtonColor:"#343a40"}),!1);Swal.fire({icon:e.icon,title:e.title,text:e.message+e.space+e.name,confirmButtonColor:"#343a40",showConfirmButton:!0}).then(e=>{$(location).attr("href","/pedidos")})}}})}}):(Swal.fire({icon:"warning",title:"Productos",text:"Debes agregar como minimo 1 producto",confirmButtonColor:"#343a40"}),!1)}function saveImage(e,t){var o=document.getElementById("LoadVoucher");let n;if(o=o.files[0],Swal.fire({title:"Validando comprobante",didOpen:()=>{Swal.showLoading(),n=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),o){var a=new FormData;a.append("id",e),a.append("name",t),a.append("image",o),$.ajax({type:"POST",dataType:"json",processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:a,url:"/order/saveImage",success:function(e){if(200!=e.status)return 100==e.status?(Swal.fire({icon:e.icon,title:e.title,text:e.message,confirmButtonColor:"#343a40"}),!1):(Swal.fire({icon:"error",title:"Ops...",text:"Ocurrio un error inesperado",confirmButtonColor:"#343a40"}),!1);Swal.fire({icon:e.icon,title:e.title,text:e.message+e.space+e.name,confirmButtonColor:"#343a40",showConfirmButton:!0}).then(e=>{e.value&&$(location).attr("href","/pedidos")})}})}else alert("No hay archivo.")}function limitar(e,t,o){var n=e.keyCode?e.keyCode:e.charCode;return 8==n||46==n||37==n||39==n||38==n||40==n||(t.length>=o?(Swal.fire({icon:"error",title:"Ops...",text:"Supero el limite de caracteres",confirmButtonColor:"#343a40"}),!1):void 0)}$(document).ready(function(){document.getElementById("identification").readOnly=!0,document.getElementById("notes").readOnly=!0,document.getElementById("delivery_date_info").readOnly=!0,$("#addProduct").click(function(e){if(e.preventDefault(),i>=9)return Swal.fire({icon:"warning",title:"Ops...",text:"Se permite maximo 10 grupos de items",confirmButtonColor:"#343a40"}),!1;{i++;let e=$("#ShowMoreProduct").clone().appendTo(".fieldGroupCopy").attr("class","input-group mb-3 copy-"+i).attr("id","copy");return document.querySelector(".copy-"+i).style.setProperty("display","flex"),e.children()[2].children[0].value="copy-"+i,e.children()[1].className="form-control col-md-11 custom-select copy",e.children()[0].className="form-control copy_quantity",!0}})});