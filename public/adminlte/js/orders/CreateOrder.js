function message(){$.ajax({url:"/message",type:"POST",contentType:"application/json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content"),contentType:"application/json"},success:function(e){}})}function CreateOrder(e){let t=document.getElementById("name_user").value,n=document.getElementById("role_id_user").value,o=document.getElementById("identification").value,a=document.getElementById("name").value,i=document.getElementById("address").value,r=document.getElementById("neighborhood").value,l=document.getElementById("phone").value,c=document.getElementById("whatsapp").value,s=document.getElementById("country_id").value,d=document.getElementById("state_id").value,u=document.getElementById("city_id").value,m=document.getElementById("payment_type_id").value,f=document.getElementById("delivery_date").value,p=document.getElementById("notes").value,g=document.getElementById("total").value,y=document.getElementById("delivery_price").value,C=document.getElementById("formFileSm").value,w=[],S=[];for(var B=0;B<$(".copy_quantity").length;B++)w.push($(".copy_quantity")[B].value);for(B=0;B<$(".copy").length;B++)S.push($(".copy")[B].value);var h=[w,S];let v=g.replace(/\$/g,"").replace(/\./g,""),_=y.replace(/\$/g,"").replace(/\./g,"");if(2==$("select[name='payment_type_id']").val()&&(null==C||""==C))return Swal.fire({icon:"warning",title:"Comprobante de pago",text:"por favor adjunte el comprobrante del deposito",confirmButtonColor:"#343a40"}),!1;for(var x=0;x<$(".copy_quantity").length;x++)if($(".copy_quantity")[x].value<=0||""==$(".copy_quantity")[x].value)return Swal.fire({icon:"warning",title:"Cantidad",text:"La cantidad digitada no es valida",confirmButtonColor:"#343a40"}),!1;if(0==o||""==o||0==a||""==a||0==i||""==i||0==l||""==l||0==r||""==r||0==c||""==c||0==f||""==f||0==v||""==v||0==m||""==m||0==s||""==s||0==d||""==d||0==u||""==u)return console.log(),Swal.fire({icon:"info",title:"Campos vacios",text:"Existen campos vacios, por favor llenelos",confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;{let s;Swal.fire({title:"Validando cliente",didOpen:()=>{Swal.showLoading(),s=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),$.ajax({url:"/pedidos/"+o+"/search",type:"GET",contentType:"application/json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content"),contentType:"application/json"},success:function(s){if(200==s.status){var d=s.d.client_data.id;Swal.fire({title:"Cliente existente",text:"El cliente de este pedido ya existe ¡¿quieres sobreescribir los datos?!",icon:"question",showCancelButton:!0,confirmButtonColor:"#343a40",cancelButtonColor:"#d33",confirmButtonText:"Si, Sobreescribir!",cancelButtonText:"Cancelar"}).then(g=>{if(g.isConfirmed)s.d&&($("#name").val(s.d.client_data.name),$("#phone").val(s.d.client_data.phone),$("#whatsapp").val(s.d.client_data.whatsapp)),Swal.fire({title:"Estas seguro?",text:"Deseas crear este nuevo pedido",icon:"question",showCancelButton:!0,confirmButtonColor:"#343a40",cancelButtonColor:"#d33",confirmButtonText:"Si, Crearlo!",cancelButtonText:"Cancelar"}).then(s=>{if(s.isConfirmed){let s,g={name_user:t,role_id_user:n,id:e,client_id:d,identification:o,name:a,address:i,neighborhood:r,phone:l,whatsapp:c,payment_type_id:m,delivery_date:f,notes:p,prod_quan:h,total:v,delivery_price:_,city_id:u};console.log(g),Swal.fire({title:"Creando Pedido",didOpen:()=>{Swal.showLoading(),s=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),$.ajax({url:"/pedidos/create",type:"POST",data:JSON.stringify(g),contentType:"application/json",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){var t=document.getElementById("formFileSm");if(500==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(400==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(404==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(t=t.files[0]){saveImage(e.d.id,e.name)}else{if(200!=e.status)return 100==e.status?(Swal.fire({icon:e.icon,title:e.title,text:e.message,confirmButtonColor:"#343a40"}),!1):(Swal.fire({icon:"error",title:"Ops...",text:"Ocurrio un error inesperado",confirmButtonColor:"#343a40"}),!1);Swal.fire({icon:e.icon,title:e.title,text:e.message+e.space+e.name,confirmButtonColor:"#343a40",showConfirmButton:!0}).then(e=>{$(location).attr("href","/pedidos")})}}})}});else if(g.dismiss)return Swal.fire({icon:"info",title:"Ops...",text:"Si quieres realizar este pedido, debe ser un cliente inexistente",confirmButtonColor:"#343a40"}),!1})}else 100==s.status&&Swal.fire({title:"Estas seguro?",text:"Deseas crear este nuevo pedido",icon:"question",showCancelButton:!0,confirmButtonColor:"#343a40",cancelButtonColor:"#d33",confirmButtonText:"Si, Crearlo!",cancelButtonText:"Cancelar"}).then(s=>{if(s.isConfirmed){let s,g={name_user:t,role_id_user:n,id:e,client_id:d,identification:o,name:a,address:i,neighborhood:r,phone:l,whatsapp:c,payment_type_id:m,delivery_date:f,notes:p,prod_quan:h,total:v,delivery_price:_,city_id:u};console.log(g),Swal.fire({title:"Creando Pedido",didOpen:()=>{Swal.showLoading(),s=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),$.ajax({url:"/pedidos/create",type:"POST",data:JSON.stringify(g),contentType:"application/json",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){var t=document.getElementById("formFileSm");if(500==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(400==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(404==e.status)return Swal.fire({icon:e.icon,title:e.name,text:e.message,confirmButtonColor:"#343a40",showConfirmButton:!0}),!1;if(t=t.files[0]){saveImage(e.d.id,e.name)}else{if(200!=e.status)return 100==e.status?(Swal.fire({icon:e.icon,title:e.title,text:e.message,confirmButtonColor:"#343a40"}),!1):(Swal.fire({icon:"error",title:"Ops...",text:"Ocurrio un error inesperado",confirmButtonColor:"#343a40"}),!1);Swal.fire({icon:e.icon,title:e.title,text:e.message+e.space+e.name,confirmButtonColor:"#343a40",showConfirmButton:!0}).then(e=>{$(location).attr("href","/pedidos")})}}})}})}})}}function saveImage(e,t){var n=document.getElementById("formFileSm");let o;if(n=n.files[0],Swal.fire({title:"Validando comprobante",didOpen:()=>{Swal.showLoading(),o=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),n){var a=new FormData;a.append("id",e),a.append("name",t),a.append("image",n),$.ajax({type:"POST",dataType:"json",processData:!1,contentType:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:a,url:"/order/saveImage",success:function(e){if(200!=e.status)return 100==e.status?(Swal.fire({icon:e.icon,title:e.title,text:e.message,confirmButtonColor:"#343a40"}),!1):(Swal.fire({icon:"error",title:"Ops...",text:"Ocurrio un error inesperado",confirmButtonColor:"#343a40"}),!1);Swal.fire({icon:e.icon,title:e.title,text:e.message+e.space+e.name,confirmButtonColor:"#343a40",showConfirmButton:!0}).then(e=>{e.value&&$(location).attr("href","http://127.0.0.1:8000/pedidos")})}})}else alert("No hay archivo.")}function searchClient(){if(client_identificacion=document.getElementById("identification").value,""==client_identificacion||0==client_identificacion)return Swal.fire({icon:"error",title:"Ops...",text:"Escriba una identificacion valida",confirmButtonColor:"#343a40"}),!1;{let e;Swal.fire({title:"Buscando Cliente",didOpen:()=>{Swal.showLoading(),e=setInterval(()=>{const e=Swal.getHtmlContainer();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)}}),$.ajax({url:"/pedidos/"+client_identificacion+"/search",type:"GET",contentType:"application/json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content"),contentType:"application/json"},success:function(e){if(200==e.status)Swal.fire({icon:e.icon,title:e.title,text:e.message+e.space+e.name,confirmButtonColor:"#343a40",showConfirmButton:!0}).then(t=>{e.d&&(console.log(e.d),$("#name").val(e.d.client_data.name),$("#phone").val(e.d.client_data.phone),$("#whatsapp").val(e.d.client_data.whatsapp))});else if(100==e.status)return Swal.fire({icon:e.icon,title:e.title,text:e.message,confirmButtonColor:"#343a40"}),!1}})}}
